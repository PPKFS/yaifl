<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Cabal, Extensions, Dependencies - Yaifl Docs</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../assets/mdbook-admonish.css">

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Introduction</a></li><li class="chapter-item expanded affix "><a href="../intro/tech.html">The Tech</a></li><li class="chapter-item expanded affix "><a href="../intro/structure.html">Structure of the book</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">The Yaifl Library</li><li class="chapter-item expanded "><a href="../foundations/foundations.html"><strong aria-hidden="true">1.</strong> Foundations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../foundations/cabal.html" class="active"><strong aria-hidden="true">1.1.</strong> Cabal, Extensions, Dependencies</a></li><li class="chapter-item expanded "><a href="../foundations/architecture.html"><strong aria-hidden="true">1.2.</strong> Project Architecture</a></li><li class="chapter-item expanded "><a href="../world/entities.html"><strong aria-hidden="true">1.3.</strong> Entities, Stores and Objects</a></li><li class="chapter-item expanded "><a href="../foundations/effects.html"><strong aria-hidden="true">1.4.</strong> Effects</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../foundations/logging.html"><strong aria-hidden="true">1.4.1.</strong> Logging</a></li></ol></li><li class="chapter-item expanded "><a href="../world/state.html"><strong aria-hidden="true">1.5.</strong> The World State</a></li><li class="chapter-item expanded "><a href="../foundations/construction.html"><strong aria-hidden="true">1.6.</strong> Construction and Execution</a></li></ol></li><li class="chapter-item expanded "><a href="../world/worldmodel.html"><strong aria-hidden="true">2.</strong> The World Model</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../world/things.html"><strong aria-hidden="true">2.1.</strong> Things and Rooms</a></li><li class="chapter-item expanded "><a href="../world/reification.html"><strong aria-hidden="true">2.2.</strong> Reification</a></li><li class="chapter-item expanded "><a href="../world/properties.html"><strong aria-hidden="true">2.3.</strong> Properties</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../world/getsetmodify.html"><strong aria-hidden="true">2.3.1.</strong> Get, Set, Modify</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../rulebooks/rulebooks.html"><strong aria-hidden="true">3.</strong> Rulebooks, Actions, and Activities</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rulebooks/running.html"><strong aria-hidden="true">3.1.</strong> Running a Rulebook</a></li><li class="chapter-item expanded "><a href="../rulebooks/ap.html"><strong aria-hidden="true">3.2.</strong> Action Processing</a></li><li class="chapter-item expanded "><a href="../rulebooks/activities.html"><strong aria-hidden="true">3.3.</strong> Activities</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Reference</li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Properties</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> Actions</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Activities</div></li><li class="chapter-item expanded affix "><li class="part-title">Examples</li><li class="chapter-item expanded "><a href="../tests/framework.html"><strong aria-hidden="true">7.</strong> Testing Framework</a></li><li class="chapter-item expanded "><a href="../tests/chapter3.html"><strong aria-hidden="true">8.</strong> Chapter 3 - Kinds</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../tests/bic.html"><strong aria-hidden="true">8.1.</strong> Bic</a></li><li class="chapter-item expanded "><a href="../tests/verbosity.html"><strong aria-hidden="true">8.2.</strong> Verbosity</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Yaifl Docs</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="cabal-extensions-dependencies"><a class="header" href="#cabal-extensions-dependencies">Cabal, Extensions, Dependencies</a></h1>
<p>This is probably a pretty dull page, so if you only care about the interesting stuff
you can skip it. But I wanted to do this literate programming thing properly, and also
it ensures I know what's going on in my <code>.cabal</code> files.</p>
<h2 id="metadata"><a class="header" href="#metadata">Metadata</a></h2>
<p>Everything here is fairly standard project information.</p>
<pre><code class="language-cabal file=yaifl.cabal header=&quot;1&quot;">cabal-version:   3.0
name:            yaifl
version:         0.0.0.1
synopsis:        Yet another interactive fiction library.
description:     Yet another interactive fiction library.
homepage:        https://github.com/PPKFS/yaifl
bug-reports:     https://github.com/PPKFS/yaifl/issues
license:         MIT
author:          Avery
maintainer:      Avery &lt;thecommunistduck@hotmail.co.uk&gt;
copyright:       2022 Avery
category:        Game Development
build-type:      Simple
tested-with: GHC == 9.2.1

source-repository head
  type:     git
  location: https://github.com/PPKFS/yaifl.git
</code></pre>
<div class="admonition question">
<div class="admonition-title">
<p>Why does the project use GHC 9.2.1?</p>
</div>
<div>
<ul>
<li>Using <code>GHC2021</code> as a <code>default-language</code> only works in 9.2, and it saves writing a huge number of extensions.</li>
<li><code>9.2.2</code> doesn't (yet) support HLS. Even with <code>entangled</code>, I like HLS because I like keeping my sanity.</li>
<li>It could probably work just fine with GHC as low as 8.8.x, but this is untested.</li>
</ul>
</div>
</div>
<h2 id="dependencies"><a class="header" href="#dependencies">Dependencies</a></h2>
<p>This is a pretty standard dependency list.</p>
<pre><code class="language-cabal file=yaifl.cabal">common common-options
  build-depends:
      base
    , containers
    , template-haskell
    , text
    , solitude
    , optics
    , mtl 
    -- to remove
    , hspec 
    -- to remove
</code></pre>
<p>I still have no idea why the first 3 of these aren't in <code>base</code>. <code>solitude</code> is my personal prelude, which is
mostly re-exports of the excellent <a href="https://hackage.haskell.org/package/relude">relude</a> alternative prelude and
also some <code>optics</code>-lens things. </p>
<div class="admonition question">
<div class="admonition-title">
<p>Why optics over lens?</p>
</div>
<div>
<ul>
<li>No idea, I just wanted to.</li>
<li>The error messages and the explicit <code>AffineTraversal</code> you get from combining a <code>Lens</code> and a <code>Prism</code> are cool though.</li>
</ul>
</div>
</div>
<pre><code class="language-cabal file=yaifl.cabal">    , display
    , chapelure
    , formatting
    , pretty-simple
    , prettyprinter
    , prettyprinter-ansi-terminal
</code></pre>
<p><code>display</code> and <code>chapelure</code> are for being <em>technically</em> lawful with <code>Show</code> instances when it comes to logging and
for making pretty error messages. The other libraries are various pretty printing for pretty logging and output.</p>
<pre><code class="language-cabal file=yaifl.cabal">    , aeson
    , katip
    , enummapset
    , haskell-src-meta
    , haskell-src-exts
    , neat-interpolation
    , sandwich
</code></pre>
<ul>
<li><code>enummapset</code> is a nice set of wrappers for using <code>Enum</code> keys in <code>IntMap</code>s for better performance (i.e. <code>Entity</code>).</li>
<li><code>haskell-src-*</code> I use because writing well-formed TH is hard, and I wanted to just write Haskell strings with
text substitutions in. </li>
<li><code>neat-interpolation</code> makes wrapped raw string quasi-quotes better, which is important given
how many room descriptions are very long lines of text. </li>
<li><code>sandwich</code> is a really sweet looking testing library so I
wanted to try it.</li>
<li><code>katip</code> for logging and <code>aeson</code> for writing some wrappers to customise the logging format.</li>
</ul>
<h2 id="ghc-extensions"><a class="header" href="#ghc-extensions">GHC extensions</a></h2>
<pre><code class="language-cabal file=yaifl.cabal">  ghc-options:
    -Wall -Wcompat -Widentities -Wredundant-constraints 
    -fhide-source-paths -Wno-unused-top-binds
    -Wmissing-deriving-strategies -O2 -flate-specialise
    -fspecialise-aggressively -fprint-potential-instances
    -fno-warn-unused-do-bind -haddock -fwrite-ide-info
  default-language:   GHC2021
  default-extensions:
    NoImplicitPrelude
    BlockArguments
    DataKinds
    DerivingStrategies
    FunctionalDependencies
    LambdaCase
    MultiWayIf
    OverloadedStrings
    TypeFamilies
</code></pre>
<p>We enable a whole bunch of options and extensions. Notably <code>NoImplicitPrelude</code> makes it easier than fiddling with
mixins for using <code>solitude</code> over <code>Prelude</code>, <code>BlockArguments</code> for my love of using inline <code>do</code> blocks, and <code>TypeFamilies</code>
because I like to try and be smarter than I am.</p>
<h2 id="library-stanza"><a class="header" href="#library-stanza">Library stanza</a></h2>
<pre><code class="language-cabal file=yaifl.cabal">library
  import:          common-options
  hs-source-dirs:  src
  exposed-modules:
    Yaifl

    Yaifl.Actions.Action
    Yaifl.Actions.Going
    Yaifl.Actions.Looking

    Yaifl.Activities.Activity
    Yaifl.Activities.ChoosingNotableLocaleObjects
    Yaifl.Activities.DescribingLocale
    Yaifl.Activities.PrintingADarkRoom
    Yaifl.Activities.PrintingDescriptionOfADarkRoom
    Yaifl.Activities.PrintingLocaleParagraphAbout
    Yaifl.Activities.PrintingNameOfSomething

    Yaifl.ActivityCollection
    Yaifl.Common
    Yaifl.Directions
    Yaifl.Game
    Yaifl.Logger

    Yaifl.Objects.Create
    Yaifl.Objects.Dynamic
    Yaifl.Objects.Missing
    Yaifl.Objects.Move
    Yaifl.Objects.Object
    Yaifl.Objects.ObjectData
    Yaifl.Objects.Query
    Yaifl.Objects.Room

    Yaifl.ObjectSpecifics
    Yaifl.Properties.Container
    Yaifl.Properties.Enclosing
    Yaifl.Properties.Openable
    Yaifl.Properties.Property
    Yaifl.Properties.Query
    Yaifl.Properties.Supporter
    Yaifl.Properties.TH

    Yaifl.Rulebooks.ActionProcessing
    Yaifl.Rulebooks.Args
    Yaifl.Rulebooks.Rulebook
    Yaifl.Rulebooks.WhenPlayBegins

    Yaifl.Say
    Yaifl.World
    Yaifl.WorldInfo
</code></pre>
<h2 id="test-stanza"><a class="header" href="#test-stanza">Test stanza</a></h2>
<pre><code class="language-cabal file=yaifl.cabal">test-suite yaifl-test
  import:             common-options
  type:               exitcode-stdio-1.0
  hs-source-dirs:     test
  main-is:            Spec.hs
  build-depends:
    , hspec
    , yaifl

  ghc-options:        -threaded -rtsopts -with-rtsopts=-N
  default-extensions:
    QuasiQuotes
    TemplateHaskell

  other-modules:
    Yaifl.Test.Chapter3.Bic
    Yaifl.Test.Chapter3.Common
    Yaifl.Test.Chapter3.Verbosity
    Yaifl.Test.Common
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../foundations/foundations.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../foundations/architecture.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../foundations/foundations.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../foundations/architecture.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
